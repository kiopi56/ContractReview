/*! For license information please see d55de749cf462b0e3f35.js.LICENSE.txt */
function _regenerator(){var e,n,r="function"==typeof Symbol?Symbol:{},t=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,t,o,a){var u=t&&t.prototype instanceof i?t:i,f=Object.create(u.prototype);return _regeneratorDefine2(f,"_invoke",function(r,t,o){var a,i,u,f=0,s=o||[],l=!1,g={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(n,r){return a=n,i=0,u=e,g.n=r,c}};function y(r,t){for(i=r,u=t,n=0;!l&&f&&!o&&n<s.length;n++){var o,a=s[n],y=g.p,p=a[2];r>3?(o=p===t)&&(u=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=r<2&&y<a[1])?(i=0,g.v=t,g.n=a[1]):y<p&&(o=r<3||a[0]>t||t>p)&&(a[4]=r,a[5]=t,g.n=p,i=0))}if(o||r>1)return c;throw l=!0,t}return function(o,s,p){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,p),i=s,u=p;(n=i<2?e:u)||!l;){a||(i?i<3?(i>1&&(g.n=-1),y(i,u)):g.n=u:g.v=u);try{if(f=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((n=(l=g.n<0)?u:r.call(t,g))!==c)break}catch(n){a=e,i=1,u=n}finally{f=1}}return{value:n,done:l}}}(r,o,a),!0),f}var c={};function i(){}function u(){}function f(){}n=Object.getPrototypeOf;var s=[][t]?n(n([][t]())):(_regeneratorDefine2(n={},t,function(){return this}),n),l=f.prototype=i.prototype=Object.create(s);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(l),e}return u.prototype=f,_regeneratorDefine2(l,"constructor",f),_regeneratorDefine2(f,"constructor",u),u.displayName="GeneratorFunction",_regeneratorDefine2(f,o,"GeneratorFunction"),_regeneratorDefine2(l),_regeneratorDefine2(l,o,"Generator"),_regeneratorDefine2(l,t,function(){return this}),_regeneratorDefine2(l,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:g}})()}function _regeneratorDefine2(e,n,r,t){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,n,r,t){if(n)o?o(e,n,{value:r,enumerable:!t,configurable:!t,writable:!t}):e[n]=r;else{var a=function(n,r){_regeneratorDefine2(e,n,function(e){return this._invoke(n,r,e)})};a("next",0),a("throw",1),a("return",2)}},_regeneratorDefine2(e,n,r,t)}function asyncGeneratorStep(e,n,r,t,o,a,c){try{var i=e[a](c),u=i.value}catch(e){return void r(e)}i.done?n(u):Promise.resolve(u).then(t,o)}function _asyncToGenerator(e){return function(){var n=this,r=arguments;return new Promise(function(t,o){var a=e.apply(n,r);function c(e){asyncGeneratorStep(a,t,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,t,o,c,i,"throw",e)}c(void 0)})}}function log(e){document.getElementById("result").textContent+=e+"\n"}function containsDamageClause(e){return/(損害賠償|賠償責任|損害の補填)/.test(e)}Office.onReady(function(){log("Office.ready"),document.getElementById("scan").onclick=_asyncToGenerator(_regenerator().m(function e(){var n,r;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return log("scan clicked"),e.p=1,e.n=2,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.body).load("text"),e.n=1,n.sync();case 1:return e.a(2,r.text)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:return log("doc len="+(n=e.v).length),e.n=3,fetch("https://localhost:5001/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:n})});case 3:return r=e.v,e.n=4,r.json();case 4:log("missing: "+e.v.missing.join(", ")),e.n=6;break;case 5:e.p=5,log("ERR "+e.v);case 6:return e.a(2)}},e,null,[[1,5]])}))}),document.getElementById("run").addEventListener("click",_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){var r,t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.body).load("text"),e.n=1,n.sync();case 1:t=document.getElementById("result"),containsDamageClause(r.text)?t.innerText="✅ 損害賠償条項：あり":t.innerText="⚠️ 損害賠償条項：なし";case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})));